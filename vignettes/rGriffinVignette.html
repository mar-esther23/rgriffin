<!DOCTYPE html>

<html xmlns="http://www.w3.org/1999/xhtml">

<head>

<meta charset="utf-8" />
<meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
<meta name="generator" content="pandoc" />

<meta name="viewport" content="width=device-width, initial-scale=1">


<meta name="date" content="2018-08-03" />

<title>rGriffin</title>



<style type="text/css">code{white-space: pre;}</style>
<style type="text/css">
div.sourceCode { overflow-x: auto; }
table.sourceCode, tr.sourceCode, td.lineNumbers, td.sourceCode {
  margin: 0; padding: 0; vertical-align: baseline; border: none; }
table.sourceCode { width: 100%; line-height: 100%; }
td.lineNumbers { text-align: right; padding-right: 4px; padding-left: 4px; color: #aaaaaa; border-right: 1px solid #aaaaaa; }
td.sourceCode { padding-left: 5px; }
code > span.kw { color: #007020; font-weight: bold; } /* Keyword */
code > span.dt { color: #902000; } /* DataType */
code > span.dv { color: #40a070; } /* DecVal */
code > span.bn { color: #40a070; } /* BaseN */
code > span.fl { color: #40a070; } /* Float */
code > span.ch { color: #4070a0; } /* Char */
code > span.st { color: #4070a0; } /* String */
code > span.co { color: #60a0b0; font-style: italic; } /* Comment */
code > span.ot { color: #007020; } /* Other */
code > span.al { color: #ff0000; font-weight: bold; } /* Alert */
code > span.fu { color: #06287e; } /* Function */
code > span.er { color: #ff0000; font-weight: bold; } /* Error */
code > span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } /* Warning */
code > span.cn { color: #880000; } /* Constant */
code > span.sc { color: #4070a0; } /* SpecialChar */
code > span.vs { color: #4070a0; } /* VerbatimString */
code > span.ss { color: #bb6688; } /* SpecialString */
code > span.im { } /* Import */
code > span.va { color: #19177c; } /* Variable */
code > span.cf { color: #007020; font-weight: bold; } /* ControlFlow */
code > span.op { color: #666666; } /* Operator */
code > span.bu { } /* BuiltIn */
code > span.ex { } /* Extension */
code > span.pp { color: #bc7a00; } /* Preprocessor */
code > span.at { color: #7d9029; } /* Attribute */
code > span.do { color: #ba2121; font-style: italic; } /* Documentation */
code > span.an { color: #60a0b0; font-weight: bold; font-style: italic; } /* Annotation */
code > span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } /* CommentVar */
code > span.in { color: #60a0b0; font-weight: bold; font-style: italic; } /* Information */
</style>



<link href="data:text/css;charset=utf-8,body%20%7B%0Abackground%2Dcolor%3A%20%23fff%3B%0Amargin%3A%201em%20auto%3B%0Amax%2Dwidth%3A%20700px%3B%0Aoverflow%3A%20visible%3B%0Apadding%2Dleft%3A%202em%3B%0Apadding%2Dright%3A%202em%3B%0Afont%2Dfamily%3A%20%22Open%20Sans%22%2C%20%22Helvetica%20Neue%22%2C%20Helvetica%2C%20Arial%2C%20sans%2Dserif%3B%0Afont%2Dsize%3A%2014px%3B%0Aline%2Dheight%3A%201%2E35%3B%0A%7D%0A%23header%20%7B%0Atext%2Dalign%3A%20center%3B%0A%7D%0A%23TOC%20%7B%0Aclear%3A%20both%3B%0Amargin%3A%200%200%2010px%2010px%3B%0Apadding%3A%204px%3B%0Awidth%3A%20400px%3B%0Aborder%3A%201px%20solid%20%23CCCCCC%3B%0Aborder%2Dradius%3A%205px%3B%0Abackground%2Dcolor%3A%20%23f6f6f6%3B%0Afont%2Dsize%3A%2013px%3B%0Aline%2Dheight%3A%201%2E3%3B%0A%7D%0A%23TOC%20%2Etoctitle%20%7B%0Afont%2Dweight%3A%20bold%3B%0Afont%2Dsize%3A%2015px%3B%0Amargin%2Dleft%3A%205px%3B%0A%7D%0A%23TOC%20ul%20%7B%0Apadding%2Dleft%3A%2040px%3B%0Amargin%2Dleft%3A%20%2D1%2E5em%3B%0Amargin%2Dtop%3A%205px%3B%0Amargin%2Dbottom%3A%205px%3B%0A%7D%0A%23TOC%20ul%20ul%20%7B%0Amargin%2Dleft%3A%20%2D2em%3B%0A%7D%0A%23TOC%20li%20%7B%0Aline%2Dheight%3A%2016px%3B%0A%7D%0Atable%20%7B%0Amargin%3A%201em%20auto%3B%0Aborder%2Dwidth%3A%201px%3B%0Aborder%2Dcolor%3A%20%23DDDDDD%3B%0Aborder%2Dstyle%3A%20outset%3B%0Aborder%2Dcollapse%3A%20collapse%3B%0A%7D%0Atable%20th%20%7B%0Aborder%2Dwidth%3A%202px%3B%0Apadding%3A%205px%3B%0Aborder%2Dstyle%3A%20inset%3B%0A%7D%0Atable%20td%20%7B%0Aborder%2Dwidth%3A%201px%3B%0Aborder%2Dstyle%3A%20inset%3B%0Aline%2Dheight%3A%2018px%3B%0Apadding%3A%205px%205px%3B%0A%7D%0Atable%2C%20table%20th%2C%20table%20td%20%7B%0Aborder%2Dleft%2Dstyle%3A%20none%3B%0Aborder%2Dright%2Dstyle%3A%20none%3B%0A%7D%0Atable%20thead%2C%20table%20tr%2Eeven%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0A%7D%0Ap%20%7B%0Amargin%3A%200%2E5em%200%3B%0A%7D%0Ablockquote%20%7B%0Abackground%2Dcolor%3A%20%23f6f6f6%3B%0Apadding%3A%200%2E25em%200%2E75em%3B%0A%7D%0Ahr%20%7B%0Aborder%2Dstyle%3A%20solid%3B%0Aborder%3A%20none%3B%0Aborder%2Dtop%3A%201px%20solid%20%23777%3B%0Amargin%3A%2028px%200%3B%0A%7D%0Adl%20%7B%0Amargin%2Dleft%3A%200%3B%0A%7D%0Adl%20dd%20%7B%0Amargin%2Dbottom%3A%2013px%3B%0Amargin%2Dleft%3A%2013px%3B%0A%7D%0Adl%20dt%20%7B%0Afont%2Dweight%3A%20bold%3B%0A%7D%0Aul%20%7B%0Amargin%2Dtop%3A%200%3B%0A%7D%0Aul%20li%20%7B%0Alist%2Dstyle%3A%20circle%20outside%3B%0A%7D%0Aul%20ul%20%7B%0Amargin%2Dbottom%3A%200%3B%0A%7D%0Apre%2C%20code%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0Aborder%2Dradius%3A%203px%3B%0Acolor%3A%20%23333%3B%0Awhite%2Dspace%3A%20pre%2Dwrap%3B%20%0A%7D%0Apre%20%7B%0Aborder%2Dradius%3A%203px%3B%0Amargin%3A%205px%200px%2010px%200px%3B%0Apadding%3A%2010px%3B%0A%7D%0Apre%3Anot%28%5Bclass%5D%29%20%7B%0Abackground%2Dcolor%3A%20%23f7f7f7%3B%0A%7D%0Acode%20%7B%0Afont%2Dfamily%3A%20Consolas%2C%20Monaco%2C%20%27Courier%20New%27%2C%20monospace%3B%0Afont%2Dsize%3A%2085%25%3B%0A%7D%0Ap%20%3E%20code%2C%20li%20%3E%20code%20%7B%0Apadding%3A%202px%200px%3B%0A%7D%0Adiv%2Efigure%20%7B%0Atext%2Dalign%3A%20center%3B%0A%7D%0Aimg%20%7B%0Abackground%2Dcolor%3A%20%23FFFFFF%3B%0Apadding%3A%202px%3B%0Aborder%3A%201px%20solid%20%23DDDDDD%3B%0Aborder%2Dradius%3A%203px%3B%0Aborder%3A%201px%20solid%20%23CCCCCC%3B%0Amargin%3A%200%205px%3B%0A%7D%0Ah1%20%7B%0Amargin%2Dtop%3A%200%3B%0Afont%2Dsize%3A%2035px%3B%0Aline%2Dheight%3A%2040px%3B%0A%7D%0Ah2%20%7B%0Aborder%2Dbottom%3A%204px%20solid%20%23f7f7f7%3B%0Apadding%2Dtop%3A%2010px%3B%0Apadding%2Dbottom%3A%202px%3B%0Afont%2Dsize%3A%20145%25%3B%0A%7D%0Ah3%20%7B%0Aborder%2Dbottom%3A%202px%20solid%20%23f7f7f7%3B%0Apadding%2Dtop%3A%2010px%3B%0Afont%2Dsize%3A%20120%25%3B%0A%7D%0Ah4%20%7B%0Aborder%2Dbottom%3A%201px%20solid%20%23f7f7f7%3B%0Amargin%2Dleft%3A%208px%3B%0Afont%2Dsize%3A%20105%25%3B%0A%7D%0Ah5%2C%20h6%20%7B%0Aborder%2Dbottom%3A%201px%20solid%20%23ccc%3B%0Afont%2Dsize%3A%20105%25%3B%0A%7D%0Aa%20%7B%0Acolor%3A%20%230033dd%3B%0Atext%2Ddecoration%3A%20none%3B%0A%7D%0Aa%3Ahover%20%7B%0Acolor%3A%20%236666ff%3B%20%7D%0Aa%3Avisited%20%7B%0Acolor%3A%20%23800080%3B%20%7D%0Aa%3Avisited%3Ahover%20%7B%0Acolor%3A%20%23BB00BB%3B%20%7D%0Aa%5Bhref%5E%3D%22http%3A%22%5D%20%7B%0Atext%2Ddecoration%3A%20underline%3B%20%7D%0Aa%5Bhref%5E%3D%22https%3A%22%5D%20%7B%0Atext%2Ddecoration%3A%20underline%3B%20%7D%0A%0Acode%20%3E%20span%2Ekw%20%7B%20color%3A%20%23555%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Edt%20%7B%20color%3A%20%23902000%3B%20%7D%20%0Acode%20%3E%20span%2Edv%20%7B%20color%3A%20%2340a070%3B%20%7D%20%0Acode%20%3E%20span%2Ebn%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Efl%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Ech%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Est%20%7B%20color%3A%20%23d14%3B%20%7D%20%0Acode%20%3E%20span%2Eco%20%7B%20color%3A%20%23888888%3B%20font%2Dstyle%3A%20italic%3B%20%7D%20%0Acode%20%3E%20span%2Eot%20%7B%20color%3A%20%23007020%3B%20%7D%20%0Acode%20%3E%20span%2Eal%20%7B%20color%3A%20%23ff0000%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%0Acode%20%3E%20span%2Efu%20%7B%20color%3A%20%23900%3B%20font%2Dweight%3A%20bold%3B%20%7D%20%20code%20%3E%20span%2Eer%20%7B%20color%3A%20%23a61717%3B%20background%2Dcolor%3A%20%23e3d2d2%3B%20%7D%20%0A" rel="stylesheet" type="text/css" />

</head>

<body>




<h1 class="title toc-ignore">rGriffin</h1>
<h4 class="author"><em>Mariana E Martinez-Sanchez</em></h4>
<h4 class="author"><em>Stalin Muñoz</em></h4>
<h4 class="author"><em>Miguel Carrillo</em></h4>
<h4 class="author"><em>Eugenio Azpeitia</em></h4>
<h4 class="author"><em>David Rosenblueth</em></h4>
<h4 class="date"><em>2018-08-03</em></h4>



<div id="introduction" class="section level2">
<h2>Introduction</h2>
<p>Phenotype is the result of the interaction of multiple genes</p>
<p>Boolean syncrolous networks are a simplification, proposed by kaufman nodes interactions state attractors</p>
<p>Biological problem</p>
<p>We can approximate the interaction graph and the attractors We are not sure of the functions</p>
<p>Does the solution exist? Is there only one solution?</p>
<p>Using a simple file interface, griffin takes as inputs biologically meaningful constraints and turns them into a symbolic representation. Using a SAT engine, griffin explores the Boolean Network search space, finding all satisfying assignments that are compatible with the specified constraints</p>
<p>This allows to determine if the information is sufficient Find the models that satisfy the restrictions</p>
<p>Incorporate multiple types of biological data with different levels of certanty.</p>
<p>Search for patterns in the families of possible networks</p>
<p>I</p>
</div>
<div id="queries" class="section level2">
<h2>Queries</h2>
<p>We are not iterating all possible networks, but determining the networks that satisfy our conditions.</p>
<p>If there are more restrictions we expect less networks. We recommend beggining with more stringent queries and then relaxing the restrictions.</p>
<p>The time that griffin will take depends on:</p>
<ul>
<li>Number of possible solutions</li>
<li>The number of regulators of each node</li>
</ul>
<div id="create-a-query" class="section level3">
<h3>Create a query</h3>
<p>All queries start with a topology that describes the nodes and its interactions. The function <code>create.gquery.graph()</code> takes a dataframe with columns for: source node, target node, and type of interaction. It also takes a vector with the node names.</p>
<p>Depending on the sign the interactions can <strong>positive</strong> or <strong>negative</strong>. If in every condition the regulation will have the same sign the interaction is <strong>ambiguous</strong>. However, if you are not sure if the regulation is positive or negative in all contexts you can say that the interaction is <strong>ambiguous</strong>. Depending on the degree of confidence in the existence of the interaction, the interactions can be: <strong>mandatory</strong> if you are sure the interaction will happen or <strong>optional</strong> if you suspect the interaction exists but you are not sure.</p>
<p>The valid types of interctions are:</p>
<ul>
<li>false: Contradiction</li>
<li>MA: Mandatory, ambiguous</li>
<li>MPU (or +): Mandatory, positive, unambiguous</li>
<li>MPPA: Mandatory, positive, possibly ambiguous</li>
<li>MNU (or -): Mandatory, negative, unambiguous</li>
<li>MNPA: Mandatory, negative, possibly ambiguous</li>
<li>MUSU: Mandatory, unknown sign, unambiguous</li>
<li>MUSPA: Mandatory, unknown sign, possibly ambiguous</li>
<li>NR: No regulation</li>
<li>OA: Optional, ambiguous</li>
<li>OPU: Optional, positive, unambiguous</li>
<li>OPPA: Optional, positive, possibly ambiguous</li>
<li>ONU: Optional, negative, unambiguous</li>
<li>ONPA: Optional, negative, possibly ambiguous</li>
<li>OUSU: Optional, unknown sign, unambiguous</li>
<li>true: Tautology</li>
</ul>
<p>For example, suppose a network where:</p>
<ul>
<li><strong>a</strong> activates <strong>b</strong></li>
<li><strong>b</strong> and <strong>c</strong> inhibit each other</li>
<li><strong>b</strong> and <strong>c</strong> <strong>may</strong> have a positive self-regulatory loops.</li>
</ul>
<p>We can codify this information as:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">genes =<span class="st"> </span><span class="kw">c</span>(<span class="st">'a'</span>,<span class="st">'b'</span>,<span class="st">'c'</span>)
inter =<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">source=</span><span class="kw">c</span>(<span class="st">'a'</span>,<span class="st">'b'</span>,<span class="st">'b'</span>,<span class="st">'c'</span>,<span class="st">'c'</span>), 
                  <span class="dt">target=</span><span class="kw">c</span>(<span class="st">'b'</span>,<span class="st">'b'</span>,<span class="st">'c'</span>,<span class="st">'b'</span>,<span class="st">'c'</span>), 
                  <span class="dt">type=</span><span class="kw">c</span>(<span class="st">'+'</span>,<span class="st">'OPU'</span>,<span class="st">'-'</span>,<span class="st">'-'</span>,<span class="st">'OPU'</span>),
                    <span class="dt">stringsAsFactors =</span> F )
inter
<span class="co">#&gt;   source target type</span>
<span class="co">#&gt; 1      a      b    +</span>
<span class="co">#&gt; 2      b      b  OPU</span>
<span class="co">#&gt; 3      b      c    -</span>
<span class="co">#&gt; 4      c      b    -</span>
<span class="co">#&gt; 5      c      c  OPU</span></code></pre></div>
<p>We then create the query <code>q</code>. This creates an instance of the class query in the JVM.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">q =<span class="st"> </span><span class="kw">create.gquery.graph</span>(inter, genes)
q
<span class="co">#&gt; [1] &quot;Java-Object{mx.unam.iimas.griffin.r.RGriffinQuery@1bba400}&quot;</span></code></pre></div>
<p>If you want to see the query use the <code>print</code> method.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">print</span>(q)
<span class="co">#&gt; Gene Regulation Specification</span>
<span class="co">#&gt;  Set of genes: [a, b, c]</span>
<span class="co">#&gt;  geneOrder: null</span>
<span class="co">#&gt;  Known regulations: None</span>
<span class="co">#&gt;  Hypothetical regulations: None</span>
<span class="co">#&gt;  Gene Interactions: [GeneInteraction [source=a, target=b, type=MPU], GeneInteraction [source=b, target=b, type=OPU], GeneInteraction [source=b, target=c, type=MNU], GeneInteraction [source=c, target=b, type=MNU], GeneInteraction [source=c, target=c, type=OPU]]</span>
<span class="co">#&gt;  Stable states: None</span>
<span class="co">#&gt;  Prohibited states: null</span>
<span class="co">#&gt;  Known Regulators: None</span>
<span class="co">#&gt;  Hypothetical Regulators: None</span>
<span class="co">#&gt;  Extended regulators: None</span>
<span class="co">#&gt;  Known Regulations: None</span>
<span class="co">#&gt;  Hypothetical Regulations: None</span>
<span class="co">#&gt;  Cyclic attractors: None</span>
<span class="co">#&gt;  Input-output pairs: []</span>
<span class="co">#&gt;  Subspaces: None</span>
<span class="co">#&gt;  Mutant experiments: None</span>
<span class="co">#&gt;  State transition rules: None</span>
<span class="co">#&gt;  exactRegulations: false</span>
<span class="co">#&gt;  additionalSteadyStates: false</span>
<span class="co">#&gt;  divideQueryByTopology: false</span>
<span class="co">#&gt;  topologyIteratorType: SEQUENTIAL</span>
<span class="co">#&gt;  limitTopologyRange: false</span>
<span class="co">#&gt;  limitToNumberOfNetworks: -1</span>
<span class="co">#&gt;  topologyRange: None</span>
<span class="co">#&gt;  topologicalDistanceRadius: 1</span>
<span class="co">#&gt;  blockSteadyAPosteriory: false</span>
<span class="co">#&gt;  additonalCycles: false</span>
<span class="co">#&gt;  ambiguityNotAllowed: true</span>
<span class="co">#&gt;  numberOfCycles:0</span></code></pre></div>
</div>
<div id="add-restrictions-to-the-query" class="section level3">
<h3>Add restrictions to the query</h3>
<p>It is possible to add more restrictions to the query. It is important to remember that if there are more restrictions we expect less networks.</p>
<p>For example, suppose that we have some information about the expected cell types. We can add this restrictions as attractors.</p>
<p>For example, suppose that we know that the attractors are:</p>
<ul>
<li>Only express <strong>b</strong> =&gt; c(0,1,0)</li>
<li>Only express <strong>c</strong> =&gt; c(0,0,1)</li>
</ul>
<p>We can also add partial attractors where we lack information</p>
<ul>
<li>Do not express <strong>a</strong> or <strong>c</strong> but we have NO information or b =&gt; c(0,’*’,0)</li>
</ul>
<p>We codify this information as:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">attr =<span class="st"> </span><span class="kw">data.frame</span>(<span class="dt">a=</span><span class="kw">c</span>(<span class="dv">0</span>,<span class="st">'*'</span>,<span class="dv">0</span>), 
                 <span class="dt">b=</span><span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">1</span>,<span class="dv">0</span>), 
                 <span class="dt">c=</span><span class="kw">c</span>(<span class="dv">0</span>,<span class="dv">0</span>,<span class="dv">1</span>),
                 <span class="dt">stringsAsFactors =</span> F )</code></pre></div>
<p>We can add this information to the query with the <code>add.gquery.attractors()</code> function:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">q =<span class="st"> </span><span class="kw">add.gquery.attractors</span>(q, attr)</code></pre></div>
<p>You can add aditional restrictions like:</p>
<ul>
<li><code>add.gquery.cycle()</code> Add target cycle</li>
<li><code>add.gquery.mutant()</code> Add mutant with attractors</li>
<li><code>add.gquery.prohibited.attractors()</code> Add prohibited attractors</li>
<li><code>add.gquery.transition()</code> Add a transition between two succesive states</li>
<li><code>add.gquery.trapspace()</code> Add a trapspace</li>
</ul>
</div>
<div id="run-the-query" class="section level3">
<h3>Run the query</h3>
<p>Once you have created the query with <code>run.gquery()</code>. This function will return all the networks that satisfy the restrictions</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">nets =<span class="st"> </span><span class="kw">run.gquery</span>(q)
<span class="kw">print</span>(nets)
<span class="co">#&gt; [1] &quot;targets,factors\na,false\nb,((((!a&amp;b)&amp;!c)|((a&amp;!b)&amp;!c))|((a&amp;b)&amp;!c))\nc,(!b&amp;c)\n&quot;                         </span>
<span class="co">#&gt; [2] &quot;targets,factors\na,false\nb,(((((!a&amp;b)&amp;!c)|((a&amp;!b)&amp;!c))|((a&amp;b)&amp;!c))|((a&amp;b)&amp;c))\nc,(!b&amp;c)\n&quot;             </span>
<span class="co">#&gt; [3] &quot;targets,factors\na,false\nb,((((((!a&amp;b)&amp;!c)|((!a&amp;b)&amp;c))|((a&amp;!b)&amp;!c))|((a&amp;b)&amp;!c))|((a&amp;b)&amp;c))\nc,(!b&amp;c)\n&quot;</span>
<span class="co">#&gt; [4] &quot;targets,factors\na,false\nb,((((!a&amp;b)&amp;!c)|((a&amp;b)&amp;!c))|((a&amp;b)&amp;c))\nc,(!b&amp;c)\n&quot;                           </span>
<span class="co">#&gt; [5] &quot;targets,factors\na,false\nb,((((((!a&amp;b)&amp;!c)|((a&amp;!b)&amp;!c))|((a&amp;!b)&amp;c))|((a&amp;b)&amp;!c))|((a&amp;b)&amp;c))\nc,(!b&amp;c)\n&quot;</span></code></pre></div>
<p>The function <code>run.gquery()</code> includes multiple options that can be seen in the documentation. Some of the most important are:</p>
<ul>
<li><code>allow.hypothesis</code> activate or deactivate hypothetical regulations</li>
<li><code>allow.additional.states</code> allows networks with additional fixed-point attractors to those specified in the query</li>
<li><code>allow.additional.cycles</code> allows networks with additional cyclic attractors to those specified in the query</li>
<li><code>return.network.limit</code> limit the maximum number of networks that the query will return</li>
</ul>
</div>
</div>
<div id="connect-to-other-packages" class="section level2">
<h2>Connect to other packages</h2>
<div id="boolnet" class="section level3">
<h3>BoolNet</h3>
<p>The R package includes various functions to import and export data to <code>BoolNet</code>.</p>
<p>It is possible to obtain the topology of a <code>BooleanNetwork</code> object using <code>get.net.topology()</code>. This function determines the sign of each regulation as positive ‘+’, negative ‘-’ or ambiguous ‘MA’. All regulations between nodes are considered mandatory. The function can also detect Non-functional regulations ‘NR’.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r"><span class="kw">library</span>(BoolNet)
<span class="kw">data</span>(<span class="st">&quot;cellcycle&quot;</span>)
topology &lt;-<span class="st"> </span><span class="kw">get.net.topology</span>(cellcycle)
topology
<span class="co">#&gt;    Source Target Interaction</span>
<span class="co">#&gt; 1    CycD   CycD           +</span>
<span class="co">#&gt; 2    CycD     Rb           -</span>
<span class="co">#&gt; 3    CycE     Rb           -</span>
<span class="co">#&gt; 4    CycA     Rb           -</span>
<span class="co">#&gt; 5     p27     Rb           +</span>
<span class="co">#&gt; 6    CycB     Rb           -</span>
<span class="co">#&gt; 7      Rb    E2F           -</span>
<span class="co">#&gt; 8    CycA    E2F           -</span>
<span class="co">#&gt; 9     p27    E2F           +</span>
<span class="co">#&gt; 10   CycB    E2F           -</span>
<span class="co">#&gt; 11     Rb   CycE           -</span>
<span class="co">#&gt; 12    E2F   CycE           +</span>
<span class="co">#&gt; 13     Rb   CycA           -</span>
<span class="co">#&gt; 14    E2F   CycA           +</span>
<span class="co">#&gt; 15   CycA   CycA           +</span>
<span class="co">#&gt; 16  Cdc20   CycA           -</span>
<span class="co">#&gt; 17   Cdh1   CycA           -</span>
<span class="co">#&gt; 18 UbcH10   CycA           -</span>
<span class="co">#&gt; 19   CycD    p27           -</span>
<span class="co">#&gt; 20   CycE    p27           -</span>
<span class="co">#&gt; 21   CycA    p27           -</span>
<span class="co">#&gt; 22    p27    p27           +</span>
<span class="co">#&gt; 23   CycB    p27           -</span>
<span class="co">#&gt; 24   CycB  Cdc20           +</span>
<span class="co">#&gt; 25   CycA   Cdh1           -</span>
<span class="co">#&gt; 26    p27   Cdh1           +</span>
<span class="co">#&gt; 27  Cdc20   Cdh1           +</span>
<span class="co">#&gt; 28   CycB   Cdh1           -</span>
<span class="co">#&gt; 29   CycA UbcH10           +</span>
<span class="co">#&gt; 30  Cdc20 UbcH10           +</span>
<span class="co">#&gt; 31   Cdh1 UbcH10           -</span>
<span class="co">#&gt; 32 UbcH10 UbcH10           +</span>
<span class="co">#&gt; 33   CycB UbcH10           +</span>
<span class="co">#&gt; 34  Cdc20   CycB           -</span>
<span class="co">#&gt; 35   Cdh1   CycB           -</span></code></pre></div>
<p>It is also possible to convert an <code>AttractorInfo</code> object into a data.frame using <code>attractor2dataframe</code>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">cc.attr &lt;-<span class="st"> </span><span class="kw">getAttractors</span>(cellcycle)
cycle &lt;-<span class="st"> </span><span class="kw">attractor2dataframe</span>(cc.attr)
cycle &lt;-<span class="st"> </span>cycle[cellcycle$genes] <span class="co">#remove info columns</span>
cycle
<span class="co">#&gt;   CycD Rb E2F CycE CycA p27 Cdc20 Cdh1 UbcH10 CycB</span>
<span class="co">#&gt; 1    0  1   0    0    0   1     0    1      0    0</span>
<span class="co">#&gt; 2    1  0   0    1    1   0     0    0      0    0</span>
<span class="co">#&gt; 3    1  0   0    0    1   0     0    0      1    1</span>
<span class="co">#&gt; 4    1  0   0    0    1   0     1    0      1    1</span>
<span class="co">#&gt; 5    1  0   0    0    0   0     1    1      1    0</span>
<span class="co">#&gt; 6    1  0   1    0    0   0     0    1      1    0</span>
<span class="co">#&gt; 7    1  0   1    1    0   0     0    1      0    0</span>
<span class="co">#&gt; 8    1  0   1    1    1   0     0    1      0    0</span></code></pre></div>
<p>Using this functions, it is possible to create a query that corresponds to a Boolean network. As we expect a cyclic attractor we will use <code>add.gquery.cycle()</code>.</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">q &lt;-<span class="st"> </span><span class="kw">create.gquery.graph</span>(topology, cellcycle$genes)
q &lt;-<span class="st"> </span><span class="kw">add.gquery.cycle</span>(q, cycle)</code></pre></div>
<p>It is also possible to export the networks generated by <code>run.gquery()</code> directly to <code>BoolNet</code> with the option <code>return = &quot;BoolNet&quot;</code>. This option generates an iterator object, that returns the <code>BooleanNetwork</code> objects one by one using the function <code>iterators::nextElem()</code>.</p>
<p>For example, if we use the three node example network:</p>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">nets =<span class="st"> </span><span class="kw">run.gquery</span>(q,<span class="dt">return =</span> <span class="st">&quot;BoolNet&quot;</span>)
<span class="co">#&gt; Warning in boolnet.model.iterator(controller): iterators is not attached</span>
iterators::<span class="kw">nextElem</span>(nets)
<span class="co">#&gt; Boolean network with 3 genes</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Involved genes:</span>
<span class="co">#&gt; a b c</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Transition functions:</span>
<span class="co">#&gt; a = 0</span>
<span class="co">#&gt; b = ((((!a&amp;b)&amp;!c)|((a&amp;!b)&amp;!c))|((a&amp;b)&amp;!c))</span>
<span class="co">#&gt; c = (!b&amp;c)</span>
<span class="co">#&gt; </span>
<span class="co">#&gt; Knocked-out and over-expressed genes:</span>
<span class="co">#&gt; a = 0</span></code></pre></div>
<p>If there are no more available networks the <code>nextElem()</code> method will rise an error: <code>Error in obj$nextElem() : StopIteration</code>.</p>
</div>
<div id="other" class="section level3">
<h3>Other</h3>
<p>It is possible to plot the network topology dataframe with the R package <code>igraph</code>. This dataframe can also be used to import and export the network topology to other resources like the python library <code>networkx</code> or to the software <code>Cytoscape</code>.</p>
<p>It is possible to export the network functions as an SBML file using the <code>BoolNet</code> function <code>toSBML()</code>.</p>
</div>
</div>
<div id="references" class="section level2">
<h2>References</h2>
<div class="sourceCode"><pre class="sourceCode r"><code class="sourceCode r">knitr::<span class="kw">kable</span>(<span class="kw">head</span>(mtcars, <span class="dv">10</span>))</code></pre></div>
<table>
<thead>
<tr class="header">
<th></th>
<th align="right">mpg</th>
<th align="right">cyl</th>
<th align="right">disp</th>
<th align="right">hp</th>
<th align="right">drat</th>
<th align="right">wt</th>
<th align="right">qsec</th>
<th align="right">vs</th>
<th align="right">am</th>
<th align="right">gear</th>
<th align="right">carb</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td>Mazda RX4</td>
<td align="right">21.0</td>
<td align="right">6</td>
<td align="right">160.0</td>
<td align="right">110</td>
<td align="right">3.90</td>
<td align="right">2.620</td>
<td align="right">16.46</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">4</td>
<td align="right">4</td>
</tr>
<tr class="even">
<td>Mazda RX4 Wag</td>
<td align="right">21.0</td>
<td align="right">6</td>
<td align="right">160.0</td>
<td align="right">110</td>
<td align="right">3.90</td>
<td align="right">2.875</td>
<td align="right">17.02</td>
<td align="right">0</td>
<td align="right">1</td>
<td align="right">4</td>
<td align="right">4</td>
</tr>
<tr class="odd">
<td>Datsun 710</td>
<td align="right">22.8</td>
<td align="right">4</td>
<td align="right">108.0</td>
<td align="right">93</td>
<td align="right">3.85</td>
<td align="right">2.320</td>
<td align="right">18.61</td>
<td align="right">1</td>
<td align="right">1</td>
<td align="right">4</td>
<td align="right">1</td>
</tr>
<tr class="even">
<td>Hornet 4 Drive</td>
<td align="right">21.4</td>
<td align="right">6</td>
<td align="right">258.0</td>
<td align="right">110</td>
<td align="right">3.08</td>
<td align="right">3.215</td>
<td align="right">19.44</td>
<td align="right">1</td>
<td align="right">0</td>
<td align="right">3</td>
<td align="right">1</td>
</tr>
<tr class="odd">
<td>Hornet Sportabout</td>
<td align="right">18.7</td>
<td align="right">8</td>
<td align="right">360.0</td>
<td align="right">175</td>
<td align="right">3.15</td>
<td align="right">3.440</td>
<td align="right">17.02</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">3</td>
<td align="right">2</td>
</tr>
<tr class="even">
<td>Valiant</td>
<td align="right">18.1</td>
<td align="right">6</td>
<td align="right">225.0</td>
<td align="right">105</td>
<td align="right">2.76</td>
<td align="right">3.460</td>
<td align="right">20.22</td>
<td align="right">1</td>
<td align="right">0</td>
<td align="right">3</td>
<td align="right">1</td>
</tr>
<tr class="odd">
<td>Duster 360</td>
<td align="right">14.3</td>
<td align="right">8</td>
<td align="right">360.0</td>
<td align="right">245</td>
<td align="right">3.21</td>
<td align="right">3.570</td>
<td align="right">15.84</td>
<td align="right">0</td>
<td align="right">0</td>
<td align="right">3</td>
<td align="right">4</td>
</tr>
<tr class="even">
<td>Merc 240D</td>
<td align="right">24.4</td>
<td align="right">4</td>
<td align="right">146.7</td>
<td align="right">62</td>
<td align="right">3.69</td>
<td align="right">3.190</td>
<td align="right">20.00</td>
<td align="right">1</td>
<td align="right">0</td>
<td align="right">4</td>
<td align="right">2</td>
</tr>
<tr class="odd">
<td>Merc 230</td>
<td align="right">22.8</td>
<td align="right">4</td>
<td align="right">140.8</td>
<td align="right">95</td>
<td align="right">3.92</td>
<td align="right">3.150</td>
<td align="right">22.90</td>
<td align="right">1</td>
<td align="right">0</td>
<td align="right">4</td>
<td align="right">2</td>
</tr>
<tr class="even">
<td>Merc 280</td>
<td align="right">19.2</td>
<td align="right">6</td>
<td align="right">167.6</td>
<td align="right">123</td>
<td align="right">3.92</td>
<td align="right">3.440</td>
<td align="right">18.30</td>
<td align="right">1</td>
<td align="right">0</td>
<td align="right">4</td>
<td align="right">4</td>
</tr>
</tbody>
</table>
<p>Also a quote using <code>&gt;</code>:</p>
<blockquote>
<p>“He who gives up [code] safety for [code] speed deserves neither.” (<a href="https://twitter.com/hadleywickham/status/504368538874703872">via</a>)</p>
</blockquote>
</div>



<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
